!function(a){"use strict";var b=a.module("ng.cork.identity",["ngRoute"]);a.isString,a.isObject,a.isFunction,a.isArray,a.copy;b.provider("corkIdentity",[function(){var b=this,c={};this.configure=function(b){a.extend(c,b)},b.$get=["$rootScope","$q",function(a,b){var c=function(){function c(){var a=b.defer();return a.$$pending=!0,g().then(function(b){a.$$pending&&(j=b,e())})["finally"](function(){a.$$pending=!1,a.resolve()}),a}function d(){h.$$pending&&(h.$$pending=!1,h.resolve())}function e(){a.$broadcast("corkIdentity.onChange",i),a.$broadcast("corkIdentity.onSet",i)}function f(){a.$broadcast("corkIdentity.onChange",i),a.$broadcast("corkIdentity.onClear",i)}var g,h,i=this,j=null;i.setAcquireMethod=function(a){g=a},i.acquire=function(){return h&&h.$$pending||(h=c()),h},i.clear=function(){d(),j&&(j=null,f())},i.set=function(a){d(),j=a,e()},Object.defineProperty(i,"ready",{get:function(){return h.promise}}),Object.defineProperty(i,"isSet",{get:function(){return null!==j}}),Object.defineProperty(i,"current",{get:function(){return j}})};return new c}]}])}(angular);